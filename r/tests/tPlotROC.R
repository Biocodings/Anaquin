#
#  Copyright (C) 2016 - Garvan Institute of Medical Research
#
#  Ted Wong, Bioinformatic Software Engineer at Garvan Institute
#

library('RUnit')
library('Anaquin')

test_1 <- function()
{
    pvals  <- c(0.88150509946551,0.790579826554692,0.703769035448768,0.327173030430958,0.675541902369305,0.27463411000412,0.128385466840651,0.89663342888243,0.0113084185194,0.747229352440727,0.399276537215399,0.292443920793433,0.0112254429527438,0.954407036854045,0.455910328939659,0.0962627125313444,0.0368961848301403,0.00993122073795335,0.839274592316032,0.816494961078089,0.0808554362362422,0.870104248850572,0.0639398485934761,0.0503499345800991,0.634624821872723,0.00767564931491453,0.658344706952809,0.0569646760950342,0.857124116442357,0.0468269349419728,0.966861022197228)
    labels <- c('FP','FP','FP','FP','FP','TP','TP','FP','TP','FP','FP','TP','TP','FP','FP','TP','TP','TP','TP','FP','TP','FP','TP','TP','TP','TP','FP','TP','FP','TP','FP')

    data <- aqData(seqs  = c(1:31),
                   pval  = pvals,
                   class = labels)
    r <- plotROC(data)
    
    checkTrue(!is.null(r$pred))
    checkTrue(!is.null(r$perf))    
}

test_1()